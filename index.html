<!DOCTYPE html>
<html>

<head>
  <title>Dls Test Demo</title>
  <style>
    body {
      padding: 24px;
    }
  </style>
</head>

<body>

  <script>
    var Module = {
      onRuntimeInitialized: function () {
        console.log('scslib version: ' + Module.version());
      }
    };
  </script>
  <script src="release/scslib.js"></script>

  <script src="interpreter/acorn_interpreter.js"></script>

<!-- 
  <script src="blockly/blockly_compressed.js"></script>
  <script src="blockly/blocks_compressed.js"></script>
  <script src="blockly/javascript_compressed.js"></script>
  <script src="blockly/msg/en.js"></script>

  <p>
    <button onclick="showCode()">Show JavaScript</button>
    <button onclick="runCode()">Run JavaScript</button>
  </p>

  <div id="blocklyDiv" style="height: 480px; width: 100%"></div>

  <script>
    var toolbox = {
      kind: 'categoryToolbox',
      contents: [
        {
          kind: 'category',
          name: 'Logic',
          categorystyle: 'logic_category',
          contents: [
            {
              kind: 'block',
              type: 'controls_if',
            },
            {
              kind: 'block',
              type: 'logic_compare',
            },
            {
              kind: 'block',
              type: 'logic_operation',
            },
            {
              kind: 'block',
              type: 'logic_negate',
            },
            {
              kind: 'block',
              type: 'logic_boolean',
            },
          ],
        },
        {
          kind: 'category',
          name: 'Loops',
          categorystyle: 'loop_category',
          contents: [
            {
              kind: 'block',
              type: 'controls_repeat_ext',
              inputs: {
                TIMES: {
                  block: {
                    type: 'math_number',
                    fields: {
                      NUM: 10,
                    },
                  },
                },
              },
            },
            {
              kind: 'block',
              type: 'controls_whileUntil',
            },
          ],
        },
        {
          kind: 'category',
          name: 'Math',
          categorystyle: 'math_category',
          contents: [
            {
              kind: 'block',
              type: 'math_number',
              fields: {
                NUM: 123,
              },
            },
            {
              kind: 'block',
              type: 'math_arithmetic',
            },
            {
              kind: 'block',
              type: 'math_single',
            },
          ],
        },
        {
          kind: 'category',
          name: 'Text',
          categorystyle: 'text_category',
          contents: [
            {
              kind: 'block',
              type: 'text',
            },
            {
              kind: 'block',
              type: 'text_length',
            },
            {
              kind: 'block',
              type: 'text_print',
            },
          ],
        },
      ],
    };

    var demoWorkspace = Blockly.inject('blocklyDiv', {
      media: '/blockly/media/',
      toolbox: toolbox,
    });

    var startBlocks = {
      blocks: {
        languageVersion: 0,
        blocks: [
          {
            type: 'controls_repeat_ext',
            inputs: {
              TIMES: {
                block: {
                  type: 'math_number',
                  fields: {
                    NUM: 10,
                  },
                },
              },
            },
          },
          {
            type: 'text_print',
            inline: false,
            inputs: {
              TEXT: {
                block: {
                  type: 'text',
                  fields: {
                    TEXT: 'Module.setScsData("scsWritePosEx", 2, 0, 0, 0)',
                  },
                },
              },
            },
          },
          {
            type: 'text_print',
            inline: false,
            inputs: {
              TEXT: {
                block: {
                  type: 'text',
                  fields: {
                    TEXT: 'Module.setScsData("scsWritePosEx", 2, 4095, 0, 0)',
                  },
                },
              },
            },
          },
        ],
      },
    };
    Blockly.serialization.workspaces.load(startBlocks, demoWorkspace);

    function showCode() {
      // Generate JavaScript code and display it.
      javascript.javascriptGenerator.INFINITE_LOOP_TRAP = null;
      var code =
        javascript.javascriptGenerator.workspaceToCode(demoWorkspace);
      alert(code);
    }

    function runCode() {
      // Generate JavaScript code and run it.
      window.LoopTrap = 1000;
      javascript.javascriptGenerator.INFINITE_LOOP_TRAP =
        'if (--window.LoopTrap < 0) throw "Infinite loop.";\n';
      var code =
        javascript.javascriptGenerator.workspaceToCode(demoWorkspace);
      javascript.javascriptGenerator.INFINITE_LOOP_TRAP = null;
      try {
        eval(code);
      } catch (e) {
        alert(e);
      }
    }
  </script>
-->

<!-- 
  <hr>

  <div class="options">

    <button id="download" hidden>Download output</button>
    <button id="clear" hidden>Clear output</button>

    <div class="info" hidden>
      <a id="polyfill_switcher"></a>
    </div>

    <label for="baudrate">Baud rate:</label>
    <select id="baudrate">
      <option value="9600">9600</option>
      <option value="14400">14400</option>
      <option value="19200">19220</option>
      <option value="28800">28800</option>
      <option value="38400">38400</option>
      <option value="57600">57600</option>
      <option value="115200">115200</option>
      <option value="230400">230400</option>
      <option value="460800">460800</option>
      <option value="500000" selected>500000</option>
      <option value="921600">921600</option>
      <option value="custom">Custom</option>
    </select>
    <input id="custom_baudrate" type="number" min="1" placeholder="Enter baudrate..." hidden>
    <label for="databits">Data bits:</label>
    <select id="databits">
      <option value="7">7</option>
      <option value="8" selected>8</option>
    </select>
    <label for="parity">Parity:</label>
    <select id="parity">
      <option value="none" selected>None</option>
      <option value="even">Even</option>
      <option value="odd">Odd</option>
    </select>
    <label for="stopbits">Stop bits:</label>
    <select id="stopbits">
      <option value="1" selected>1</option>
      <option value="2">2</option>
    </select>
    <input id="rtscts" type="checkbox">
    <label for="rtscts">Hardware flow control</label>

    <br>

    <button id="search">Search</button>

    <label for="ports">Port:</label>
    <select id="ports">
      <option value="prompt">Click 'Connect' to add a port...</option>
    </select>
    <button id="connect">Connect</button>

    <button hidden id="debug1">debug1</button>

    <button hidden id="debug2">debug2</button>

    <input hidden id="echo" type="checkbox">
    <label hidden class="checkbox" for="echo">Local echo</label>
    <input hidden id="enter_flush" type="checkbox">
    <label hidden class="checkbox" for="enter_flush">Flush on enter</label>
    <input hidden id="convert_eol" type="checkbox">
    <label hidden class="checkbox" for="convert_eol">Convert EOL</label>
    <input hidden id="autoconnect" type="checkbox">
    <label hidden class="checkbox" for="autoconnect">Automatically connect</label>
  
    <div id="terminal" hidden></div>

  </div>

  <hr>
-->

  <div id="app">

  </div>

  <script type="module" src="/src/index.ts"></script>
  <!-- 
  <script src="https://unpkg.com/vconsole@latest/dist/vconsole.min.js"></script>
  <script>
    var vConsole = new window.VConsole();
  </script>
 -->

</body>

</html>